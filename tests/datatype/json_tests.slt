# Generated from datatypes_json_tests.json
# Total test cases: 40

# Test Case 1/40
# JSONç±»å‹-ç©ºå¯¹è±¡æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨ç©ºå¯¹è±¡{}

statement ok
DROP TABLE IF EXISTS test_json_empty_obj;


statement ok
CREATE TABLE test_json_empty_obj (id INT, data JSON);

statement ok
INSERT INTO test_json_empty_obj VALUES (1, JSON '{}');

query TT
SELECT * FROM test_json_empty_obj;
----
1 {}

statement ok
DROP TABLE test_json_empty_obj;


# Test Case 2/40
# JSONç±»å‹-ç©ºæ•°ç»„æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨ç©ºæ•°ç»„[]

statement ok
DROP TABLE IF EXISTS test_json_empty_array;


statement ok
CREATE TABLE test_json_empty_array (id INT, data JSON);

statement ok
INSERT INTO test_json_empty_array VALUES (1, JSON '[]');

query TT
SELECT * FROM test_json_empty_array;
----
1 []

statement ok
DROP TABLE test_json_empty_array;


# Test Case 3/40
# JSONç±»å‹-å•ä¸ªå­—ç¬¦ä¸²å€¼æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨å•ä¸ªå­—ç¬¦ä¸²å€¼

statement ok
DROP TABLE IF EXISTS test_json_string;


statement ok
CREATE TABLE test_json_string (id INT, data JSON);

statement ok
INSERT INTO test_json_string VALUES (1, JSON '"hello"'), (2, JSON '"world"');

query TT
SELECT * FROM test_json_string ORDER BY id;
----
1 "hello"
2 "world"

statement ok
DROP TABLE test_json_string;


# Test Case 4/40
# JSONç±»å‹-å•ä¸ªæ•°å€¼æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨å•ä¸ªæ•°å€¼

statement ok
DROP TABLE IF EXISTS test_json_number;


statement ok
CREATE TABLE test_json_number (id INT, data JSON);

statement ok
INSERT INTO test_json_number VALUES (1, JSON '123'), (2, JSON '456.789'), (3, JSON '-100');

query TT
SELECT * FROM test_json_number ORDER BY id;
----
1 123
2 456.789
3 -100

statement ok
DROP TABLE test_json_number;


# Test Case 5/40
# JSONç±»å‹-å•ä¸ªå¸ƒå°”å€¼æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨å¸ƒå°”å€¼trueå’Œfalse

statement ok
DROP TABLE IF EXISTS test_json_boolean;


statement ok
CREATE TABLE test_json_boolean (id INT, data JSON);

statement ok
INSERT INTO test_json_boolean VALUES (1, JSON 'true'), (2, JSON 'false');

query TT
SELECT * FROM test_json_boolean ORDER BY id;
----
1 true
2 false

statement ok
DROP TABLE test_json_boolean;


# Test Case 6/40
# JSONç±»å‹-nullå€¼æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨JSON nullå€¼

statement ok
DROP TABLE IF EXISTS test_json_null_value;


statement ok
CREATE TABLE test_json_null_value (id INT, data JSON);

statement ok
INSERT INTO test_json_null_value VALUES (1, JSON 'null'), (2, JSON '{"key": null}');

query TT
SELECT * FROM test_json_null_value ORDER BY id;
----
1 null
2 {"key":null}

statement ok
DROP TABLE test_json_null_value;


# Test Case 7/40
# JSONç±»å‹-ç®€å•å¯¹è±¡æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨ç®€å•å¯¹è±¡

statement ok
DROP TABLE IF EXISTS test_json_simple_obj;


statement ok
CREATE TABLE test_json_simple_obj (id INT, data JSON);

statement ok
INSERT INTO test_json_simple_obj VALUES (1, JSON '{"name":"Alice","age":30}'), (2, JSON '{"city":"Beijing","country":"China"}');

query TT
SELECT * FROM test_json_simple_obj ORDER BY id;
----
1 {"name":"Alice","age":30}
2 {"city":"Beijing","country":"China"}

statement ok
DROP TABLE test_json_simple_obj;


# Test Case 8/40
# JSONç±»å‹-åµŒå¥—å¯¹è±¡2å±‚æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨ä¸¤å±‚åµŒå¥—å¯¹è±¡

statement ok
DROP TABLE IF EXISTS test_json_nested_2;


statement ok
CREATE TABLE test_json_nested_2 (id INT, data JSON);

statement ok
INSERT INTO test_json_nested_2 VALUES (1, JSON '{"user":{"name":"Bob","email":"bob@example.com"}}');

query TT
SELECT * FROM test_json_nested_2;
----
1 {"user":{"name":"Bob","email":"bob@example.com"}}

statement ok
DROP TABLE test_json_nested_2;


# Test Case 9/40
# JSONç±»å‹-åµŒå¥—å¯¹è±¡3å±‚æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨ä¸‰å±‚åµŒå¥—å¯¹è±¡

statement ok
DROP TABLE IF EXISTS test_json_nested_3;


statement ok
CREATE TABLE test_json_nested_3 (id INT, data JSON);

statement ok
INSERT INTO test_json_nested_3 VALUES (1, JSON '{"company":{"department":{"team":{"name":"DevOps","size":5}}}}');

query TT
SELECT * FROM test_json_nested_3;
----
1 {"company":{"department":{"team":{"name":"DevOps","size":5}}}}

statement ok
DROP TABLE test_json_nested_3;


# Test Case 10/40
# JSONç±»å‹-æ·±åº¦åµŒå¥—å¯¹è±¡5å±‚æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨äº”å±‚æ·±åº¦åµŒå¥—

statement ok
DROP TABLE IF EXISTS test_json_nested_5;


statement ok
CREATE TABLE test_json_nested_5 (id INT, data JSON);

statement ok
INSERT INTO test_json_nested_5 VALUES (1, JSON '{"l1":{"l2":{"l3":{"l4":{"l5":"deep value"}}}}}');

query TT
SELECT * FROM test_json_nested_5;
----
1 {"l1":{"l2":{"l3":{"l4":{"l5":"deep value"}}}}}

statement ok
DROP TABLE test_json_nested_5;


# Test Case 11/40
# JSONç±»å‹-ç®€å•æ•°ç»„æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨ç®€å•æ•°ç»„

statement ok
DROP TABLE IF EXISTS test_json_simple_array;


statement ok
CREATE TABLE test_json_simple_array (id INT, data JSON);

statement ok
INSERT INTO test_json_simple_array VALUES (1, JSON '[1,2,3,4,5]'), (2, JSON '["a","b","c"]'), (3, JSON '[true,false,true]');

query TT
SELECT * FROM test_json_simple_array ORDER BY id;
----
1 [1,2,3,4,5]
2 ["a","b","c"]
3 [true,false,true]

statement ok
DROP TABLE test_json_simple_array;


# Test Case 12/40
# JSONç±»å‹-å¯¹è±¡æ•°ç»„æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨å¯¹è±¡æ•°ç»„

statement ok
DROP TABLE IF EXISTS test_json_obj_array;


statement ok
CREATE TABLE test_json_obj_array (id INT, data JSON);

statement ok
INSERT INTO test_json_obj_array VALUES (1, JSON '[{"name":"Alice","age":30},{"name":"Bob","age":25}]');

query TT
SELECT * FROM test_json_obj_array;
----
1 [{"name":"Alice","age":30},{"name":"Bob","age":25}]

statement ok
DROP TABLE test_json_obj_array;


# Test Case 13/40
# JSONç±»å‹-åµŒå¥—æ•°ç»„æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨åµŒå¥—æ•°ç»„

statement ok
DROP TABLE IF EXISTS test_json_nested_array;


statement ok
CREATE TABLE test_json_nested_array (id INT, data JSON);

statement ok
INSERT INTO test_json_nested_array VALUES (1, JSON '[[1,2,3],[4,5,6],[7,8,9]]'), (2, JSON '[[[1,2],[3,4]],[[5,6],[7,8]]]');

query TT
SELECT * FROM test_json_nested_array ORDER BY id;
----
1 [[1,2,3],[4,5,6],[7,8,9]]
2 [[[1,2],[3,4]],[[5,6],[7,8]]]

statement ok
DROP TABLE test_json_nested_array;


# Test Case 14/40
# JSONç±»å‹-å¯¹è±¡åŒ…å«æ•°ç»„æµ‹è¯•
# æµ‹è¯•JSONå¯¹è±¡ä¸­åŒ…å«æ•°ç»„

statement ok
DROP TABLE IF EXISTS test_json_obj_with_array;


statement ok
CREATE TABLE test_json_obj_with_array (id INT, data JSON);

statement ok
INSERT INTO test_json_obj_with_array VALUES (1, JSON '{"user":"Alice","scores":[90,85,88]}');

query TT
SELECT * FROM test_json_obj_with_array;
----
1 {"user":"Alice","scores":[90,85,88]}

statement ok
DROP TABLE test_json_obj_with_array;


# Test Case 15/40
# JSONç±»å‹-æ•°ç»„åŒ…å«å¯¹è±¡æµ‹è¯•
# æµ‹è¯•JSONæ•°ç»„ä¸­åŒ…å«å¯¹è±¡

statement ok
DROP TABLE IF EXISTS test_json_array_with_obj;


statement ok
CREATE TABLE test_json_array_with_obj (id INT, data JSON);

statement ok
INSERT INTO test_json_array_with_obj VALUES (1, JSON '[{"id":1,"items":["a","b"]},{"id":2,"items":["c","d"]}]');

query TT
SELECT * FROM test_json_array_with_obj;
----
1 [{"id":1,"items":["a","b"]},{"id":2,"items":["c","d"]}]

statement ok
DROP TABLE test_json_array_with_obj;


# Test Case 16/40
# JSONç±»å‹-å¤æ‚æ··åˆç»“æ„æµ‹è¯•
# æµ‹è¯•JSONç±»å‹å­˜å‚¨å¤æ‚æ··åˆç»“æ„

statement ok
DROP TABLE IF EXISTS test_json_complex_mix;


statement ok
CREATE TABLE test_json_complex_mix (id INT, data JSON);

statement ok
INSERT INTO test_json_complex_mix VALUES (1, JSON '{"user":{"name":"Alice","contacts":[{"type":"email","value":"alice@example.com"},{"type":"phone","value":"123456789"}],"preferences":{"theme":"dark","notifications":["email","sms"]}}}');

query TT
SELECT * FROM test_json_complex_mix;
----
1 {"user":{"name":"Alice","contacts":[{"type":"email","value":"alice@example.com"},{"type":"phone","value":"123456789"}],"preferences":{"theme":"dark","notifications":["email","sms"]}}}

statement ok
DROP TABLE test_json_complex_mix;


# Test Case 17/40
# JSONç±»å‹-ç‰¹æ®Šå­—ç¬¦æµ‹è¯•-å¼•å·
# æµ‹è¯•JSONä¸­åŒ…å«å¼•å·ç­‰ç‰¹æ®Šå­—ç¬¦

statement ok
DROP TABLE IF EXISTS test_json_special_chars;


statement ok
CREATE TABLE test_json_special_chars (id INT, data JSON);

statement ok
INSERT INTO test_json_special_chars VALUES (1, JSON '{"text":"He said \"Hello\""}');

query TT
SELECT * FROM test_json_special_chars;
----
1 {"text":"He said \"Hello\""}

statement ok
DROP TABLE test_json_special_chars;


# Test Case 18/40
# JSONç±»å‹-ç‰¹æ®Šå­—ç¬¦æµ‹è¯•-æ¢è¡Œç¬¦
# æµ‹è¯•JSONä¸­åŒ…å«æ¢è¡Œç¬¦ç­‰æ§åˆ¶å­—ç¬¦

statement ok
DROP TABLE IF EXISTS test_json_newline;


statement ok
CREATE TABLE test_json_newline (id INT, data JSON);

statement ok
INSERT INTO test_json_newline VALUES (1, JSON '{"text":"Line1\nLine2"}');

query TT
SELECT * FROM test_json_newline;
----
1 {"text":"Line1\nLine2"}

statement ok
DROP TABLE test_json_newline;


# Test Case 19/40
# JSONç±»å‹-Unicodeå­—ç¬¦æµ‹è¯•
# æµ‹è¯•JSONä¸­åŒ…å«Unicodeå­—ç¬¦

statement ok
DROP TABLE IF EXISTS test_json_unicode;


statement ok
CREATE TABLE test_json_unicode (id INT, data JSON);

statement ok
INSERT INTO test_json_unicode VALUES (1, JSON '{"name":"å¼ ä¸‰","city":"åŒ—äº¬"}'), (2, JSON '{"emoji":"ğŸ˜€ğŸ˜ğŸ˜‚"}');

query TT
SELECT * FROM test_json_unicode ORDER BY id;
----
1 {"name":"å¼ ä¸‰","city":"åŒ—äº¬"}
2 {"emoji":"ğŸ˜€ğŸ˜ğŸ˜‚"}

statement ok
DROP TABLE test_json_unicode;


# Test Case 20/40
# JSONç±»å‹-å¤§æ•°å€¼æµ‹è¯•
# æµ‹è¯•JSONä¸­å­˜å‚¨å¤§æ•°å€¼

statement ok
DROP TABLE IF EXISTS test_json_large_number;


statement ok
CREATE TABLE test_json_large_number (id INT, data JSON);

statement ok
INSERT INTO test_json_large_number VALUES (1, JSON '{"value":9999999999999}'), (2, JSON '{"decimal":123456789.987654321}');

query TT
SELECT * FROM test_json_large_number ORDER BY id;
----
1 {"value":9999999999999}
2 {"decimal":123456789.987654321}

statement ok
DROP TABLE test_json_large_number;


# Test Case 21/40
# JSONç±»å‹-å¤§é‡é”®å€¼å¯¹æµ‹è¯•
# æµ‹è¯•JSONå¯¹è±¡åŒ…å«å¤§é‡é”®å€¼å¯¹

statement ok
DROP TABLE IF EXISTS test_json_many_keys;


statement ok
CREATE TABLE test_json_many_keys (id INT, data JSON);

statement ok
INSERT INTO test_json_many_keys VALUES (1, JSON '{"k1":"v1","k2":"v2","k3":"v3","k4":"v4","k5":"v5","k6":"v6","k7":"v7","k8":"v8","k9":"v9","k10":"v10"}');

query TT
SELECT * FROM test_json_many_keys;
----
1 {"k1":"v1","k2":"v2","k3":"v3","k4":"v4","k5":"v5","k6":"v6","k7":"v7","k8":"v8","k9":"v9","k10":"v10"}

statement ok
DROP TABLE test_json_many_keys;


# Test Case 22/40
# JSONç±»å‹-å¤§æ•°ç»„æµ‹è¯•
# æµ‹è¯•JSONæ•°ç»„åŒ…å«å¤§é‡å…ƒç´ 

statement ok
DROP TABLE IF EXISTS test_json_large_array;


statement ok
CREATE TABLE test_json_large_array (id INT, data JSON);

statement ok
INSERT INTO test_json_large_array VALUES (1, JSON '[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]');

query TT
SELECT * FROM test_json_large_array;
----
1 [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]

statement ok
DROP TABLE test_json_large_array;


# Test Case 23/40
# JSONç±»å‹-é”™è¯¯æµ‹è¯•-æ— æ•ˆæ ¼å¼
# æµ‹è¯•æ’å…¥æ— æ•ˆJSONæ ¼å¼çš„é”™è¯¯å¤„ç†

statement ok
DROP TABLE IF EXISTS test_json_invalid;


statement ok
CREATE TABLE test_json_invalid (id INT, data JSON);

statement error
INSERT INTO test_json_invalid VALUES (1, JSON '{invalid json}');

statement ok
DROP TABLE test_json_invalid;


# Test Case 24/40
# JSONç±»å‹-é”™è¯¯æµ‹è¯•-æœªé—­åˆå¤§æ‹¬å·
# æµ‹è¯•æ’å…¥æœªé—­åˆå¤§æ‹¬å·çš„JSON

statement ok
DROP TABLE IF EXISTS test_json_unclosed_brace;


statement ok
CREATE TABLE test_json_unclosed_brace (id INT, data JSON);

statement error
INSERT INTO test_json_unclosed_brace VALUES (1, JSON '{"key":"value"');

statement ok
DROP TABLE test_json_unclosed_brace;


# Test Case 25/40
# JSONç±»å‹-é”™è¯¯æµ‹è¯•-æœªé—­åˆæ–¹æ‹¬å·
# æµ‹è¯•æ’å…¥æœªé—­åˆæ–¹æ‹¬å·çš„JSONæ•°ç»„

statement ok
DROP TABLE IF EXISTS test_json_unclosed_bracket;


statement ok
CREATE TABLE test_json_unclosed_bracket (id INT, data JSON);

statement error
INSERT INTO test_json_unclosed_bracket VALUES (1, JSON '[1,2,3');

statement ok
DROP TABLE test_json_unclosed_bracket;


# Test Case 26/40
# JSONç±»å‹-NULLåˆ—å€¼æµ‹è¯•
# æµ‹è¯•JSONåˆ—çš„SQL NULLå€¼

statement ok
DROP TABLE IF EXISTS test_json_sql_null;


statement ok
CREATE TABLE test_json_sql_null (id INT, data JSON);

statement ok
INSERT INTO test_json_sql_null VALUES (1, NULL), (2, JSON '{"value":null}'), (3, JSON 'null');

query TT
SELECT id, CASE WHEN data IS NULL THEN 'SQL NULL' ELSE 'NOT NULL' END AS null_check FROM test_json_sql_null ORDER BY id;
----
1 SQL NULL
2 NOT NULL
3 NOT NULL

statement ok
DROP TABLE test_json_sql_null;


# Test Case 27/40
# JSONå‡½æ•°-JSON_VALUEæå–å­—ç¬¦ä¸²
# æµ‹è¯•JSON_VALUEå‡½æ•°æå–å­—ç¬¦ä¸²å€¼

statement ok
DROP TABLE IF EXISTS test_json_value_str;


statement ok
CREATE TABLE test_json_value_str (id INT, data JSON);

statement ok
INSERT INTO test_json_value_str VALUES (1, JSON '{"name":"Alice","age":30}');

query TT
SELECT id, JSON_VALUE(data, '$.name') AS name FROM test_json_value_str;
----
1 Alice

statement ok
DROP TABLE test_json_value_str;


# Test Case 28/40
# JSONå‡½æ•°-JSON_VALUEæå–æ•°å€¼
# æµ‹è¯•JSON_VALUEå‡½æ•°æå–æ•°å€¼

statement ok
DROP TABLE IF EXISTS test_json_value_num;


statement ok
CREATE TABLE test_json_value_num (id INT, data JSON);

statement ok
INSERT INTO test_json_value_num VALUES (1, JSON '{"name":"Alice","age":30}');

query TT
SELECT id, JSON_VALUE(data, '$.age') AS age FROM test_json_value_num;
----
1 30

statement ok
DROP TABLE test_json_value_num;


# Test Case 29/40
# JSONå‡½æ•°-JSON_VALUEæå–åµŒå¥—å€¼
# æµ‹è¯•JSON_VALUEå‡½æ•°æå–åµŒå¥—å¯¹è±¡ä¸­çš„å€¼

statement ok
DROP TABLE IF EXISTS test_json_value_nested;


statement ok
CREATE TABLE test_json_value_nested (id INT, data JSON);

statement ok
INSERT INTO test_json_value_nested VALUES (1, JSON '{"user":{"profile":{"name":"Bob"}}}');

query TT
SELECT id, JSON_VALUE(data, '$.user.profile.name') AS name FROM test_json_value_nested;
----
1 Bob

statement ok
DROP TABLE test_json_value_nested;


# Test Case 30/40
# JSONå‡½æ•°-JSON_QUERYæå–å¯¹è±¡
# æµ‹è¯•JSON_QUERYå‡½æ•°æå–JSONå¯¹è±¡

statement ok
DROP TABLE IF EXISTS test_json_query_obj;


statement ok
CREATE TABLE test_json_query_obj (id INT, data JSON);

statement ok
INSERT INTO test_json_query_obj VALUES (1, JSON '{"user":{"name":"Alice","age":30}}');

query TT
SELECT id, JSON_QUERY(data, '$.user') AS user_obj FROM test_json_query_obj;
----
1 {"name":"Alice","age":30}

statement ok
DROP TABLE test_json_query_obj;


# Test Case 31/40
# JSONå‡½æ•°-JSON_QUERYæå–æ•°ç»„
# æµ‹è¯•JSON_QUERYå‡½æ•°æå–JSONæ•°ç»„

statement ok
DROP TABLE IF EXISTS test_json_query_array;


statement ok
CREATE TABLE test_json_query_array (id INT, data JSON);

statement ok
INSERT INTO test_json_query_array VALUES (1, JSON '{"scores":[90,85,88]}');

query TT
SELECT id, JSON_QUERY(data, '$.scores') AS scores_array FROM test_json_query_array;
----
1 [90,85,88]

statement ok
DROP TABLE test_json_query_array;


# Test Case 32/40
# JSONæŸ¥è¯¢-WHEREæ¡ä»¶è¿‡æ»¤
# æµ‹è¯•åŸºäºJSONå†…å®¹çš„WHEREæ¡ä»¶è¿‡æ»¤

statement ok
DROP TABLE IF EXISTS test_json_where;


statement ok
CREATE TABLE test_json_where (id INT, data JSON);

statement ok
INSERT INTO test_json_where VALUES (1, JSON '{"status":"active"}'), (2, JSON '{"status":"inactive"}'), (3, JSON '{"status":"active"}');

query T
SELECT id FROM test_json_where WHERE JSON_VALUE(data, '$.status') = 'active' ORDER BY id;
----
1
3

statement ok
DROP TABLE test_json_where;


# Test Case 33/40
# JSONæŸ¥è¯¢-æ•°å€¼èŒƒå›´è¿‡æ»¤
# æµ‹è¯•åŸºäºJSONæ•°å€¼çš„èŒƒå›´è¿‡æ»¤

statement ok
DROP TABLE IF EXISTS test_json_range;


statement ok
CREATE TABLE test_json_range (id INT, data JSON);

statement ok
INSERT INTO test_json_range VALUES (1, JSON '{"score":85}'), (2, JSON '{"score":92}'), (3, JSON '{"score":78}');

query T
SELECT id FROM test_json_range WHERE CAST(JSON_VALUE(data, '$.score') AS INT) >= 80 ORDER BY id;
----
1
2

statement ok
DROP TABLE test_json_range;


# Test Case 34/40
# JSONç´¢å¼•-åˆ›å»ºå‡½æ•°ç´¢å¼•
# æµ‹è¯•åœ¨JSONå‡½æ•°è¡¨è¾¾å¼ä¸Šåˆ›å»ºç´¢å¼•

statement ok
DROP TABLE IF EXISTS test_json_func_index;


statement ok
CREATE TABLE test_json_func_index (id INT PRIMARY KEY, data JSON);

statement ok
INSERT INTO test_json_func_index VALUES (1, JSON '{"category":"A"}'), (2, JSON '{"category":"B"}'), (3, JSON '{"category":"A"}');

query T
SELECT COUNT(*) AS count FROM test_json_func_index WHERE JSON_VALUE(data, '$.category') = 'A';
----
2

statement ok
DROP TABLE test_json_func_index;


# Test Case 35/40
# JSONæ›´æ–°-æ•´ä½“æ›¿æ¢
# æµ‹è¯•æ›´æ–°æ•´ä¸ªJSONæ–‡æ¡£

statement ok
DROP TABLE IF EXISTS test_json_update;


statement ok
CREATE TABLE test_json_update (id INT, data JSON);

statement ok
INSERT INTO test_json_update VALUES (1, JSON '{"status":"draft"}');

statement ok
UPDATE test_json_update SET data = JSON '{"status":"published"}' WHERE id = 1;

query TT
SELECT * FROM test_json_update;
----
1 {"status":"published"}

statement ok
DROP TABLE test_json_update;


# Test Case 36/40
# JSONèšåˆ-COUNTç»Ÿè®¡
# æµ‹è¯•å¯¹JSONåˆ—è¿›è¡ŒCOUNTç»Ÿè®¡

statement ok
DROP TABLE IF EXISTS test_json_count;


statement ok
CREATE TABLE test_json_count (id INT, data JSON);

statement ok
INSERT INTO test_json_count VALUES (1, JSON '{}'), (2, NULL), (3, JSON '[]'), (4, JSON '{"key":"value"}');

query TT
SELECT COUNT(*) AS total, COUNT(data) AS non_null FROM test_json_count;
----
4 3

statement ok
DROP TABLE test_json_count;


# Test Case 37/40
# JSONèšåˆ-GROUP BYåˆ†ç»„
# æµ‹è¯•åŸºäºJSONå†…å®¹çš„GROUP BYåˆ†ç»„

statement ok
DROP TABLE IF EXISTS test_json_groupby;


statement ok
CREATE TABLE test_json_groupby (id INT, data JSON, value INT);

statement ok
INSERT INTO test_json_groupby VALUES (1, JSON '{"type":"A"}', 100), (2, JSON '{"type":"B"}', 200), (3, JSON '{"type":"A"}', 150);

query TT
SELECT JSON_VALUE(data, '$.type') AS type, SUM(value) AS total FROM test_json_groupby GROUP BY JSON_VALUE(data, '$.type') ORDER BY type;
----
A 250
B 200

statement ok
DROP TABLE test_json_groupby;


# Test Case 38/40
# JSON JOIN-åŸºäºJSONå†…å®¹è¿æ¥
# æµ‹è¯•åŸºäºJSONå†…å®¹çš„è¡¨è¿æ¥

statement ok
DROP TABLE IF EXISTS test_json_join_t1;


statement ok
CREATE TABLE test_json_join_t1 (id INT, data JSON);

statement ok
DROP TABLE IF EXISTS test_json_join_t2;


statement ok
CREATE TABLE test_json_join_t2 (id INT, category VARCHAR(50), description VARCHAR(100));

statement ok
INSERT INTO test_json_join_t1 VALUES (1, JSON '{"cat":"A"}'), (2, JSON '{"cat":"B"}');

statement ok
INSERT INTO test_json_join_t2 VALUES (1, 'A', 'Category A'), (2, 'B', 'Category B');

query TT
SELECT t1.id, t2.description FROM test_json_join_t1 t1 JOIN test_json_join_t2 t2 ON JSON_VALUE(t1.data, '$.cat') = t2.category ORDER BY t1.id;
----
1 Category A
2 Category B

statement ok
DROP TABLE test_json_join_t1;

statement ok
DROP TABLE test_json_join_t2;


# Test Case 39/40
# JSONæ€§èƒ½-å¤§JSONæ–‡æ¡£æµ‹è¯•
# æµ‹è¯•å­˜å‚¨å’ŒæŸ¥è¯¢å¤§JSONæ–‡æ¡£

statement ok
DROP TABLE IF EXISTS test_json_large_doc;


statement ok
CREATE TABLE test_json_large_doc (id INT, data JSON);

query T
SELECT COUNT(*) AS count FROM test_json_large_doc;
----
0

statement ok
DROP TABLE test_json_large_doc;


# Test Case 40/40
# JSONæ€§èƒ½-æ‰¹é‡æ’å…¥æµ‹è¯•
# æµ‹è¯•æ‰¹é‡æ’å…¥JSONæ•°æ®

statement ok
DROP TABLE IF EXISTS test_json_bulk;


statement ok
CREATE TABLE test_json_bulk (id INT, data JSON);

statement ok
INSERT INTO test_json_bulk SELECT ROWNUM, JSON '{"id":' || ROWNUM || ',"value":"data' || ROWNUM || '"}' FROM DUAL CONNECT BY ROWNUM <= 1000;

query T
SELECT COUNT(*) AS total FROM test_json_bulk;
----
1000

statement ok
DROP TABLE test_json_bulk;
