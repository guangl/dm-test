# Test Case Name: VARCHAR类型聚合函数测试
# Description: 测试VARCHAR类型在聚合函数中的使用
# Category: datatype/varchar

statement ok
DROP TABLE IF EXISTS test_varchar_aggregate;

statement ok
CREATE TABLE test_varchar_aggregate (id INTEGER PRIMARY KEY, department VARCHAR(50), employee VARCHAR(50));

statement ok
INSERT INTO test_varchar_aggregate VALUES (1, 'Sales', 'Alice'), (2, 'IT', 'Bob'), (3, 'Sales', 'Charlie'), (4, 'IT', 'David');

query TI
SELECT department, COUNT(*) FROM test_varchar_aggregate GROUP BY department ORDER BY department;
----
IT 2
Sales 2

query T
SELECT MAX(employee) FROM test_varchar_aggregate WHERE department = 'Sales';
----
Charlie

statement ok
DROP TABLE test_varchar_aggregate;
